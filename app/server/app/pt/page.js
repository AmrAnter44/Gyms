(()=>{var e={};e.id=1043,e.ids=[1043],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},98238:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>x,pages:()=>c,routeModule:()=>m,tree:()=>o}),t(626),t(84658),t(35866);var a=t(23191),r=t(88716),l=t(37922),n=t.n(l),i=t(95231),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);t.d(s,d);let o=["",{children:["pt",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,626)),"C:\\Users\\amran\\Desktop\\gym\\gym-management\\app\\pt\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,84658)),"C:\\Users\\amran\\Desktop\\gym\\gym-management\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\amran\\Desktop\\gym\\gym-management\\app\\pt\\page.tsx"],x="/pt/page",p={require:t,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/pt/page",pathname:"/pt",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},30861:(e,s,t)=>{Promise.resolve().then(t.bind(t,37425))},37425:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var a=t(10326),r=t(17577),l=t(35047),n=t(58864);function i(){let e=(0,l.useRouter)(),[s,t]=(0,r.useState)([]),[i,d]=(0,r.useState)([]),[o,c]=(0,r.useState)(!1),[x,p]=(0,r.useState)(null),[m,u]=(0,r.useState)(!0),[h,g]=(0,r.useState)(!0),[b,j]=(0,r.useState)(""),[N,y]=(0,r.useState)(""),[f,v]=(0,r.useState)({ptNumber:"",clientName:"",phone:"",sessionsPurchased:8,coachName:"",pricePerSession:0,startDate:(0,n.ze)(new Date),expiryDate:"",paymentMethod:"cash"}),w=async()=>{try{let e=await fetch("/api/pt"),s=await e.json();t(s)}catch(e){console.error("Error:",e)}finally{u(!1)}},D=()=>{v({ptNumber:"",clientName:"",phone:"",sessionsPurchased:8,coachName:"",pricePerSession:0,startDate:(0,n.ze)(new Date),expiryDate:"",paymentMethod:"cash"}),p(null),c(!1)},P=e=>{if(!f.startDate)return;let s=new Date(new Date(f.startDate));s.setMonth(s.getMonth()+e),v(e=>({...e,expiryDate:(0,n.ze)(s)}))},C=async e=>{e.preventDefault(),u(!0),j("");try{let e=x?{ptNumber:x.ptNumber,...f}:f,s=await fetch("/api/pt",{method:x?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),t=await s.json();s.ok?(j(x?"✅ تم تحديث جلسة PT بنجاح!":"✅ تم إضافة جلسة PT بنجاح!"),setTimeout(()=>j(""),3e3),w(),D()):j(`❌ ${t.error||"فشلت العملية"}`)}catch(e){console.error(e),j("❌ حدث خطأ")}finally{u(!1)}},S=s=>{e.push(`/pt/renew?ptNumber=${s.ptNumber}`)},k=s=>{e.push(`/pt/sessions/register?ptNumber=${s.ptNumber}`)},T=s.filter(e=>e.clientName.toLowerCase().includes(N.toLowerCase())||e.coachName.toLowerCase().includes(N.toLowerCase())||e.ptNumber.toString().includes(N)||e.phone.includes(N)),q=s.reduce((e,s)=>e+s.sessionsPurchased,0),_=s.reduce((e,s)=>e+s.sessionsRemaining,0),$=s.filter(e=>e.sessionsRemaining>0).length;return(0,a.jsxs)("div",{className:"container mx-auto p-6",dir:"rtl",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-2",children:"\uD83D\uDCAA إدارة جلسات PT"}),a.jsx("p",{className:"text-gray-600",children:"إضافة وتعديل وحذف جلسات التدريب الشخصي"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)("button",{onClick:()=>e.push("/pt/commission"),className:"bg-gradient-to-r from-purple-600 to-purple-700 text-white px-6 py-2 rounded-lg hover:from-purple-700 hover:to-purple-800 transition transform hover:scale-105 shadow-lg flex items-center gap-2",children:[a.jsx("span",{children:"\uD83D\uDCB0"}),a.jsx("span",{children:"حاسبة التحصيل"})]}),(0,a.jsxs)("button",{onClick:()=>e.push("/pt/sessions/history"),className:"bg-gradient-to-r from-indigo-600 to-indigo-700 text-white px-6 py-2 rounded-lg hover:from-indigo-700 hover:to-indigo-800 transition transform hover:scale-105 shadow-lg flex items-center gap-2",children:[a.jsx("span",{children:"\uD83D\uDCCA"}),a.jsx("span",{children:"سجل الحضور"})]}),a.jsx("button",{onClick:()=>{D(),c(!o)},className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition transform hover:scale-105",children:o?"إخفاء النموذج":"➕ إضافة جلسة PT جديدة"})]})]}),b&&a.jsx("div",{className:`mb-6 p-4 rounded-lg ${b.includes("✅")?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:b}),o&&(0,a.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-lg mb-6 border-2 border-blue-100",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:x?"تعديل جلسة PT":"إضافة جلسة PT جديدة"}),(0,a.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1",children:["رقم ID ",a.jsx("span",{className:"text-red-600",children:"*"})]}),a.jsx("input",{type:"number",required:!0,disabled:!!x,value:f.ptNumber,onChange:e=>v({...f,ptNumber:e.target.value}),className:"w-full px-3 py-2 border rounded-lg disabled:bg-gray-100",placeholder:"مثال: 1001"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1",children:["اسم العميل ",a.jsx("span",{className:"text-red-600",children:"*"})]}),a.jsx("input",{type:"text",required:!0,value:f.clientName,onChange:e=>v({...f,clientName:e.target.value}),className:"w-full px-3 py-2 border rounded-lg",placeholder:"اسم العميل"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"رقم الهاتف"}),a.jsx("input",{type:"tel",value:f.phone,onChange:e=>v({...f,phone:e.target.value}),className:"w-full px-3 py-2 border rounded-lg",placeholder:"01xxxxxxxxx"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1",children:["اسم الكوتش ",a.jsx("span",{className:"text-red-600",children:"*"})]}),h?a.jsx("div",{className:"w-full px-3 py-2 border rounded-lg bg-gray-50 text-gray-500",children:"جاري تحميل الكوتشات..."}):0===i.length?(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("input",{type:"text",required:!0,value:f.coachName,onChange:e=>v({...f,coachName:e.target.value}),className:"w-full px-3 py-2 border rounded-lg",placeholder:"اسم الكوتش"}),a.jsx("p",{className:"text-xs text-amber-600",children:"⚠️ لا يوجد كوتشات نشطين. يمكنك الإدخال يدوياً"})]}):(0,a.jsxs)("select",{required:!0,value:f.coachName,onChange:e=>v({...f,coachName:e.target.value}),className:"w-full px-3 py-2 border rounded-lg bg-white",children:[a.jsx("option",{value:"",children:"-- اختر الكوتش --"}),i.map(e=>(0,a.jsxs)("option",{value:e.name,children:[e.name," ",e.phone&&`(${e.phone})`]},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1",children:["عدد الجلسات ",a.jsx("span",{className:"text-red-600",children:"*"})]}),a.jsx("input",{type:"number",required:!0,min:"1",value:f.sessionsPurchased,onChange:e=>v({...f,sessionsPurchased:parseInt(e.target.value)}),className:"w-full px-3 py-2 border rounded-lg",placeholder:"8"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1",children:["سعر الجلسة (ج.م) ",a.jsx("span",{className:"text-red-600",children:"*"})]}),a.jsx("input",{type:"number",required:!0,min:"0",step:"0.01",value:f.pricePerSession,onChange:e=>v({...f,pricePerSession:parseFloat(e.target.value)}),className:"w-full px-3 py-2 border rounded-lg",placeholder:"200"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1",children:["تاريخ البداية ",a.jsx("span",{className:"text-xs text-gray-500",children:"(yyyy-mm-dd)"})]}),a.jsx("input",{type:"text",value:f.startDate,onChange:e=>v({...f,startDate:e.target.value}),className:"w-full px-3 py-2 border rounded-lg font-mono",placeholder:"2025-11-18",pattern:"\\d{4}-\\d{2}-\\d{2}"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium mb-1",children:["تاريخ الانتهاء ",a.jsx("span",{className:"text-xs text-gray-500",children:"(yyyy-mm-dd)"})]}),a.jsx("input",{type:"text",value:f.expiryDate,onChange:e=>v({...f,expiryDate:e.target.value}),className:"w-full px-3 py-2 border rounded-lg font-mono",placeholder:"2025-12-18",pattern:"\\d{4}-\\d{2}-\\d{2}"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-medium mb-2",children:"⚡ إضافة سريعة:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:[1,2,3,6,9,12].map(e=>(0,a.jsxs)("button",{type:"button",onClick:()=>P(e),className:"px-3 py-2 bg-blue-100 hover:bg-blue-200 text-blue-800 rounded-lg text-sm transition font-medium",children:["+ ",e," ",1===e?"شهر":"أشهر"]},e))})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"طريقة الدفع"}),(0,a.jsxs)("select",{value:f.paymentMethod,onChange:e=>v({...f,paymentMethod:e.target.value}),className:"w-full px-3 py-2 border rounded-lg",children:[a.jsx("option",{value:"cash",children:"\uD83D\uDCB5 كاش"}),a.jsx("option",{value:"visa",children:"\uD83D\uDCB3 فيزا"}),a.jsx("option",{value:"instapay",children:"\uD83D\uDCF1 انستاباي"})]})]}),f.sessionsPurchased>0&&f.pricePerSession>0&&a.jsx("div",{className:"bg-green-50 border-2 border-green-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-lg font-semibold",children:"الإجمالي:"}),(0,a.jsxs)("span",{className:"text-2xl font-bold text-green-600",children:[(f.sessionsPurchased*f.pricePerSession).toFixed(2)," ج.م"]})]})}),(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx("button",{type:"submit",disabled:m,className:"flex-1 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 disabled:bg-gray-400",children:m?"جاري الحفظ...":x?"تحديث":"إضافة جلسة PT"}),x&&a.jsx("button",{type:"button",onClick:D,className:"px-6 bg-gray-200 text-gray-700 py-2 rounded-lg hover:bg-gray-300",children:"إلغاء"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[a.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-lg p-6 shadow-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-blue-100 text-sm mb-1",children:"إجمالي الجلسات"}),a.jsx("p",{className:"text-4xl font-bold",children:q})]}),a.jsx("div",{className:"text-5xl opacity-20",children:"\uD83D\uDCAA"})]})}),a.jsx("div",{className:"bg-gradient-to-br from-green-500 to-green-600 text-white rounded-lg p-6 shadow-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-green-100 text-sm mb-1",children:"الجلسات المتبقية"}),a.jsx("p",{className:"text-4xl font-bold",children:_})]}),a.jsx("div",{className:"text-5xl opacity-20",children:"⏳"})]})}),a.jsx("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white rounded-lg p-6 shadow-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-purple-100 text-sm mb-1",children:"PT نشطة"}),a.jsx("p",{className:"text-4xl font-bold",children:$})]}),a.jsx("div",{className:"text-5xl opacity-20",children:"\uD83D\uDD25"})]})})]}),a.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:a.jsx("input",{type:"text",placeholder:"\uD83D\uDD0D ابحث برقم PT أو اسم العميل أو الكوتش أو رقم الهاتف...",value:N,onChange:e=>y(e.target.value),className:"w-full px-4 py-3 border-2 rounded-lg text-lg"})}),m?a.jsx("div",{className:"text-center py-12",children:"جاري التحميل..."}):(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-100",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-right",children:"رقم PT"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"العميل"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"الكوتش"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"الجلسات"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"السعر"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"الإجمالي"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"التواريخ"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"إجراءات"})]})}),a.jsx("tbody",{children:T.map(e=>{let s=e.expiryDate&&new Date(e.expiryDate)<new Date(Date.now()+6048e5),t=e.expiryDate&&new Date(e.expiryDate)<new Date;return(0,a.jsxs)("tr",{className:`border-t hover:bg-gray-50 ${t?"bg-red-50":s?"bg-yellow-50":""}`,children:[a.jsx("td",{className:"px-4 py-3",children:(0,a.jsxs)("span",{className:"font-bold text-blue-600",children:["#",e.ptNumber]})}),a.jsx("td",{className:"px-4 py-3",children:(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-semibold",children:e.clientName}),a.jsx("p",{className:"text-sm text-gray-600",children:e.phone})]})}),a.jsx("td",{className:"px-4 py-3",children:e.coachName}),a.jsx("td",{className:"px-4 py-3",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:`font-bold ${0===e.sessionsRemaining?"text-red-600":e.sessionsRemaining<=3?"text-orange-600":"text-green-600"}`,children:e.sessionsRemaining}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["من ",e.sessionsPurchased]})]})}),(0,a.jsxs)("td",{className:"px-4 py-3",children:[e.pricePerSession," ج.م"]}),(0,a.jsxs)("td",{className:"px-4 py-3 font-bold text-green-600",children:[(e.sessionsPurchased*e.pricePerSession).toFixed(0)," ج.م"]}),a.jsx("td",{className:"px-4 py-3",children:(0,a.jsxs)("div",{className:"text-xs font-mono",children:[e.startDate&&(0,a.jsxs)("p",{children:["من: ",(0,n.ze)(e.startDate)]}),e.expiryDate&&(0,a.jsxs)("p",{className:t?"text-red-600 font-bold":"",children:["إلى: ",(0,n.ze)(e.expiryDate)]}),t&&a.jsx("p",{className:"text-red-600 font-bold",children:"❌ منتهية"}),!t&&s&&a.jsx("p",{className:"text-orange-600 font-bold",children:"⚠️ قريبة الانتهاء"})]})}),a.jsx("td",{className:"px-4 py-3",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[a.jsx("button",{onClick:()=>k(e),disabled:0===e.sessionsRemaining,className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"✅ حضور"}),a.jsx("button",{onClick:()=>S(e),className:"bg-purple-600 text-white px-3 py-1 rounded text-sm hover:bg-purple-700",children:"\uD83D\uDD04 تجديد"})]})})]},e.ptNumber)})})]})}),0===T.length&&a.jsx("div",{className:"text-center py-12 text-gray-500",children:N?"لا توجد نتائج للبحث":"لا توجد جلسات PT حالياً"})]})]})}},58864:(e,s,t)=>{"use strict";function a(e){if(!e)return"-";let s="string"==typeof e?new Date(e):e;if(isNaN(s.getTime()))return"-";let t=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0"),r=String(s.getDate()).padStart(2,"0");return`${t}-${a}-${r}`}function r(e,s){let t="string"==typeof e?new Date(e):e;return Math.ceil((("string"==typeof s?new Date(s):s).getTime()-t.getTime())/864e5)}function l(e){if(!e)return null;let s="string"==typeof e?new Date(e):e,t=new Date;return t.setHours(0,0,0,0),r(t,s)}function n(e){if(e<30)return`${e} يوم`;let s=Math.round(e/30);return`${e} يوم (≈ ${s} ${1===s?"شهر":"أشهر"})`}t.d(s,{DL:()=>n,pi:()=>r,rY:()=>l,ze:()=>a})},626:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`C:\Users\amran\Desktop\gym\gym-management\app\pt\page.tsx#default`)},57481:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});var a=t(66621);let r=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[8948,9206,6621,9797],()=>t(98238));module.exports=a})();