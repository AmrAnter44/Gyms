(()=>{var e={};e.id=9091,e.ids=[9091],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},83606:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>r.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>u,tree:()=>o}),t(57395),t(84658),t(35866);var l=t(23191),n=t(88716),a=t(37922),r=t.n(a),d=t(95231),i={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>d[e]);t.d(s,i);let o=["",{children:["members",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,57395)),"C:\\Users\\amran\\Desktop\\gym\\gym-management\\app\\members\\[id]\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,84658)),"C:\\Users\\amran\\Desktop\\gym\\gym-management\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\amran\\Desktop\\gym\\gym-management\\app\\members\\[id]\\page.tsx"],x="/members/[id]/page",m={require:t,loadChunk:()=>Promise.resolve()},u=new l.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/members/[id]/page",pathname:"/members/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},19744:(e,s,t)=>{Promise.resolve().then(t.bind(t,63257))},63257:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>x});var l=t(10326),n=t(17577),a=t(35047),r=t(79330),d=t(33971),i=t(58864);function o({member:e,onSuccess:s,onClose:t}){let[a,r]=(0,n.useState)(""),[o,c]=(0,n.useState)("0"),[x,m]=(0,n.useState)("0"),[u,b]=(0,n.useState)("0"),[p,g]=(0,n.useState)("0"),[h,j]=(0,n.useState)((0,i.ze)(new Date)),[y,f]=(0,n.useState)(""),[N,v]=(0,n.useState)(e.notes||""),[w,D]=(0,n.useState)("cash"),[C,k]=(0,n.useState)(""),[S,P]=(0,n.useState)(!1),[T,I]=(0,n.useState)(""),B=e=>{if(!h)return;let s=new Date(new Date(h));s.setMonth(s.getMonth()+e),f((0,i.ze)(s))},A=()=>(parseInt(a)||0)-(parseInt(o)||0),M=async()=>{if(!a||0>=parseInt(a)){I("⚠️ يرجى إدخال سعر اشتراك صحيح");return}if(!C.trim()){I("⚠️ يرجى إدخال اسم الموظف");return}if(!h||!y){I("⚠️ يرجى تحديد تاريخ البداية والانتهاء");return}if(new Date(y)<=new Date(h)){I("⚠️ تاريخ الانتهاء يجب أن يكون بعد تاريخ البداية");return}P(!0),I("");try{console.log("\uD83D\uDCC4 إرسال طلب التجديد...");let t=await fetch("/api/members/renew",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({memberId:e.id,subscriptionPrice:parseInt(a),remainingAmount:parseInt(o)||0,freePTSessions:parseInt(x)||0,inBodyScans:parseInt(u)||0,invitations:parseInt(p)||0,startDate:h,expiryDate:y,notes:N,paymentMethod:w,staffName:C.trim()})});if(t.ok){let e=await t.json();console.log("✅ تم التجديد بنجاح:",e),e.receipt?s(e.receipt):s()}else{let e=await t.json();I(e.error||"❌ فشل تجديد الاشتراك")}}catch(e){console.error("❌ خطأ في التجديد:",e),I("❌ حدث خطأ غير متوقع")}finally{P(!1)}},$=h&&y?(0,i.pi)(h,y):0;a&&parseInt(a);let z=(e.freePTSessions||0)+(parseInt(x)||0);return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:9999},onClick:e=>{e.target===e.currentTarget&&t()},children:(0,l.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6",onClick:e=>e.stopPropagation(),children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6 sticky top-0 bg-white pb-4 border-b",children:[(0,l.jsxs)("h3",{className:"text-2xl font-bold flex items-center gap-2",children:[l.jsx("span",{children:"\uD83D\uDD04"}),l.jsx("span",{children:"تجديد اشتراك"})]}),l.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 text-3xl leading-none",type:"button",children:"\xd7"})]}),(0,l.jsxs)("div",{className:"bg-blue-50 border-r-4 border-blue-500 p-4 rounded-lg mb-6",children:[l.jsx("h4",{className:"font-bold text-blue-900 mb-2",children:"معلومات العضو"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,l.jsxs)("p",{className:"text-blue-800",children:[l.jsx("strong",{children:"الاسم:"})," ",e.name]}),(0,l.jsxs)("p",{className:"text-blue-800",children:[l.jsx("strong",{children:"رقم العضوية:"})," #",e.memberNumber]}),(0,l.jsxs)("p",{className:"text-blue-800",children:[l.jsx("strong",{children:"حصص PT الحالية:"})," ",e.freePTSessions||0]}),(0,l.jsxs)("p",{className:"text-blue-800",children:[l.jsx("strong",{children:"InBody الحالي:"})," ",e.inBodyScans||0]}),(0,l.jsxs)("p",{className:"text-blue-800",children:[l.jsx("strong",{children:"الدعوات الحالية:"})," ",e.invitations||0]}),e.expiryDate&&(0,l.jsxs)("p",{className:"text-blue-800",children:[l.jsx("strong",{children:"تاريخ الانتهاء السابق:"})," ",(0,i.ze)(e.expiryDate)]})]})]}),T&&l.jsx("div",{className:"bg-red-50 border-r-4 border-red-500 p-4 rounded-lg mb-4",children:l.jsx("p",{className:"text-red-700 font-medium",children:T})}),(0,l.jsxs)("form",{onSubmit:e=>{e.preventDefault(),M()},className:"space-y-6",children:[(0,l.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,l.jsxs)("h4",{className:"font-bold text-gray-800 mb-4 flex items-center gap-2",children:[l.jsx("span",{children:"\uD83D\uDCB0"}),l.jsx("span",{children:"تفاصيل التجديد"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["سعر الاشتراك ",l.jsx("span",{className:"text-red-600",children:"*"})]}),l.jsx("input",{type:"number",value:a,onChange:e=>r(e.target.value),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:border-blue-500",placeholder:"مثال: 1000",min:"0",required:!0})]}),(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"المبلغ المتبقي"}),l.jsx("input",{type:"number",value:o,onChange:e=>c(e.target.value),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:border-blue-500",placeholder:"0",min:"0"})]}),(0,l.jsxs)("div",{className:"col-span-2",children:[(0,l.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["اسم الموظف ",l.jsx("span",{className:"text-red-600",children:"*"})]}),l.jsx("input",{type:"text",required:!0,value:C,onChange:e=>k(e.target.value),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:border-blue-500",placeholder:"اسم الموظف المجدد"})]})]}),a&&l.jsx("div",{className:"mt-4 bg-green-50 border-2 border-green-300 rounded-lg p-3",children:(0,l.jsxs)("p",{className:"text-sm text-green-800",children:["\uD83D\uDCB5 ",l.jsx("strong",{children:"المبلغ المدفوع:"})," ",A()," جنيه"]})})]}),(0,l.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,l.jsxs)("h4",{className:"font-bold text-gray-800 mb-4 flex items-center gap-2",children:[l.jsx("span",{children:"\uD83C\uDF81"}),l.jsx("span",{children:"الحصص الإضافية (اختياري)"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"\uD83C\uDFCB️ حصص PT إضافية"}),l.jsx("input",{type:"number",value:x,onChange:e=>m(e.target.value),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:border-purple-500",placeholder:"0",min:"0"}),parseInt(x)>0&&(0,l.jsxs)("p",{className:"text-xs text-purple-600 mt-1",children:["✅ الإجمالي: ",(e.freePTSessions||0)+parseInt(x)]})]}),(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"⚖️ InBody Scans إضافية"}),l.jsx("input",{type:"number",value:u,onChange:e=>b(e.target.value),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:border-purple-500",placeholder:"0",min:"0"}),parseInt(u)>0&&(0,l.jsxs)("p",{className:"text-xs text-purple-600 mt-1",children:["✅ الإجمالي: ",(e.inBodyScans||0)+parseInt(u)]})]}),(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"\uD83C\uDF9F️ دعوات إضافية"}),l.jsx("input",{type:"number",value:p,onChange:e=>g(e.target.value),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:border-purple-500",placeholder:"0",min:"0"}),parseInt(p)>0&&(0,l.jsxs)("p",{className:"text-xs text-purple-600 mt-1",children:["✅ الإجمالي: ",(e.invitations||0)+parseInt(p)]})]})]})]}),(0,l.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,l.jsxs)("h4",{className:"font-bold text-gray-800 mb-4 flex items-center gap-2",children:[l.jsx("span",{children:"\uD83D\uDCC5"}),l.jsx("span",{children:"فترة الاشتراك"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["تاريخ البداية ",l.jsx("span",{className:"text-red-600",children:"*"})," ",l.jsx("span",{className:"text-xs text-gray-500",children:"(yyyy-mm-dd)"})]}),l.jsx("input",{type:"text",value:h,onChange:e=>j(e.target.value),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:border-blue-500 font-mono text-lg",placeholder:"2025-11-18",pattern:"\\d{4}-\\d{2}-\\d{2}",required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["تاريخ الانتهاء ",l.jsx("span",{className:"text-red-600",children:"*"})," ",l.jsx("span",{className:"text-xs text-gray-500",children:"(yyyy-mm-dd)"})]}),l.jsx("input",{type:"text",value:y,onChange:e=>f(e.target.value),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:border-blue-500 font-mono text-lg",placeholder:"2025-12-18",pattern:"\\d{4}-\\d{2}-\\d{2}",required:!0})]})]}),(0,l.jsxs)("div",{className:"mb-4",children:[l.jsx("p",{className:"text-sm font-medium mb-2",children:"⚡ إضافة سريعة:"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:[1,2,3,6,9,12].map(e=>(0,l.jsxs)("button",{type:"button",onClick:()=>B(e),className:"px-3 py-2 bg-blue-100 hover:bg-blue-200 text-blue-800 rounded-lg text-sm transition font-medium",children:["+ ",e," ",1===e?"شهر":"أشهر"]},e))})]}),$>0&&y&&l.jsx("div",{className:"bg-blue-50 border-2 border-blue-300 rounded-lg p-3",children:(0,l.jsxs)("p",{className:"text-sm text-blue-800",children:["⏱️ ",l.jsx("strong",{children:"مدة الاشتراك:"})," ",$," يوم",$>=30&&` (${Math.floor($/30)} ${1===Math.floor($/30)?"شهر":"أشهر"})`]})})]}),(0,l.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,l.jsxs)("h4",{className:"font-bold text-gray-800 mb-4 flex items-center gap-2",children:[l.jsx("span",{children:"\uD83D\uDCB3"}),l.jsx("span",{children:"طريقة الدفع"})]}),l.jsx(d.ZP,{value:w,onChange:D})]}),(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"\uD83D\uDCDD ملاحظات (اختياري)"}),l.jsx("textarea",{value:N,onChange:e=>v(e.target.value),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:border-blue-500",rows:3,placeholder:"أي ملاحظات إضافية..."})]}),(0,l.jsxs)("div",{className:"bg-yellow-50 border-2 border-yellow-200 rounded-lg p-6",children:[(0,l.jsxs)("h4",{className:"font-bold text-gray-800 mb-4 flex items-center gap-2",children:[l.jsx("span",{children:"\uD83D\uDCCA"}),l.jsx("span",{children:"ملخص التجديد"})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"الجلسات الحالية:"}),(0,l.jsxs)("span",{className:"font-bold",children:[e.freePTSessions||0," جلسة"]})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-gray-600",children:"الجلسات الجديدة:"}),(0,l.jsxs)("span",{className:"font-bold text-green-600",children:["+ ",parseInt(x)||0," جلسة"]})]}),l.jsx("div",{className:"border-t-2 border-gray-300 pt-3",children:(0,l.jsxs)("div",{className:"flex justify-between text-xl",children:[l.jsx("span",{className:"font-bold",children:"الإجمالي بعد التجديد:"}),(0,l.jsxs)("span",{className:"font-bold text-orange-600",children:[z," جلسة"]})]})}),l.jsx("div",{className:"bg-green-100 border-r-4 border-green-500 p-3 rounded mt-3",children:(0,l.jsxs)("div",{className:"flex justify-between text-lg",children:[l.jsx("span",{className:"font-bold text-gray-800",children:"المبلغ المدفوع:"}),(0,l.jsxs)("span",{className:"font-bold text-green-600",children:[A()," ج.م"]})]})})]})]}),(0,l.jsxs)("div",{className:"flex gap-3 sticky bottom-0 bg-white pt-4 border-t",children:[l.jsx("button",{type:"submit",disabled:S||$<=0,className:"flex-1 bg-gradient-to-r from-blue-600 to-blue-700 text-white py-4 rounded-lg hover:from-blue-700 hover:to-blue-800 disabled:from-gray-400 disabled:to-gray-400 font-bold text-lg shadow-lg transition-all",children:S?(0,l.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,l.jsxs)("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),l.jsx("span",{children:"جاري التجديد..."})]}):"✅ تأكيد التجديد"}),l.jsx("button",{type:"button",onClick:t,disabled:S,className:"px-8 bg-gray-200 text-gray-700 py-4 rounded-lg hover:bg-gray-300 disabled:bg-gray-100 font-bold",children:"إلغاء"})]})]})]})})}function c({memberNumber:e,memberName:s,memberPhone:t}){let[a,r]=(0,n.useState)(!1),[d,i]=(0,n.useState)(""),[o,c]=(0,n.useState)(!1),x=async()=>{c(!0);try{let s=await fetch("/api/barcode",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e.toString()})}),t=await s.json();t.barcode?(i(t.barcode),r(!0)):alert("حدث خطأ أثناء توليد الباركود")}catch(e){console.error("Error generating barcode:",e),alert("حدث خطأ أثناء توليد الباركود")}finally{c(!1)}},m=()=>{if(!d)return;let s=document.createElement("a");s.href=d,s.download=`barcode-${e}.png`,s.click()},u=()=>{if(!d)return alert("يجب توليد الباركود أولاً");m(),setTimeout(()=>{let l=`Barcode العضوية #${e} للعضو ${s}`,n=t.replace(/\D/g,""),a=`https://wa.me/${2+n}?text=${encodeURIComponent(l)}`;window.open(a,"_blank"),alert("✅ تم تحميل صورة الباركود!\n\uD83D\uDCF1 سيتم فتح واتساب الآن، قم بإرفاق الصورة المحملة مع الرسالة.")},500)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-2 border-blue-200",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:l.jsx("span",{className:"text-3xl",children:"\uD83D\uDCF1"})}),(0,l.jsxs)("div",{children:[l.jsx("h3",{className:"text-xl font-bold",children:"Barcode العضوية"}),l.jsx("p",{className:"text-sm text-gray-600",children:"عرض أو إرسال باركود رقم العضوية"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,l.jsxs)("button",{onClick:x,disabled:o,className:"bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed font-bold flex items-center justify-center gap-2",children:[l.jsx("span",{children:"\uD83D\uDD22"}),l.jsx("span",{children:"عرض Barcode"})]}),(0,l.jsxs)("button",{onClick:u,disabled:o,className:"bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed font-bold flex items-center justify-center gap-2",children:[l.jsx("span",{children:"\uD83D\uDCF2"}),l.jsx("span",{children:"تحميل وإرسال واتساب"})]})]})]}),a&&d&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:9999},onClick:e=>{e.target===e.currentTarget&&r(!1)},children:(0,l.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",onClick:e=>e.stopPropagation(),children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[l.jsx("h3",{className:"text-2xl font-bold",children:"\uD83D\uDD22 Barcode العضوية"}),l.jsx("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-gray-600 text-3xl leading-none",type:"button",children:"\xd7"})]}),(0,l.jsxs)("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-4 mb-6 text-center",children:[l.jsx("p",{className:"text-sm text-blue-600 mb-2",children:"العضو"}),l.jsx("p",{className:"text-xl font-bold text-blue-800",children:s}),(0,l.jsxs)("p",{className:"text-3xl font-bold text-blue-600 mt-2",children:["#",e]})]}),l.jsx("div",{className:"bg-white border-2 border-gray-200 rounded-lg p-6 mb-6 flex justify-center",children:l.jsx("img",{src:d,alt:`Barcode ${e}`,className:"max-w-full h-auto"})}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("button",{onClick:m,className:"w-full bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 font-bold flex items-center justify-center gap-2",children:[l.jsx("span",{children:"\uD83D\uDCBE"}),l.jsx("span",{children:"تحميل الصورة"})]}),(0,l.jsxs)("button",{onClick:()=>{u(),r(!1)},className:"w-full bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 font-bold flex items-center justify-center gap-2",children:[l.jsx("span",{children:"\uD83D\uDCF2"}),l.jsx("span",{children:"تحميل وإرسال عبر واتساب"})]}),l.jsx("button",{onClick:()=>r(!1),className:"w-full bg-gray-200 text-gray-700 py-3 rounded-lg hover:bg-gray-300 font-bold",children:"إغلاق"})]})]})})]})}function x(){let e=(0,a.useParams)(),s=(0,a.useRouter)(),t=e.id,[x,m]=(0,n.useState)(null),[u,b]=(0,n.useState)(!0),[p,g]=(0,n.useState)(""),[h,j]=(0,n.useState)(!1),[y,f]=(0,n.useState)(null),[N,v]=(0,n.useState)(!1),[w,D]=(0,n.useState)(null),[C,k]=(0,n.useState)({amount:0,paymentMethod:"cash",notes:""}),[S,P]=(0,n.useState)({days:0,reason:""}),[T,I]=(0,n.useState)({guestName:"",guestPhone:"",notes:""}),[B,A]=(0,n.useState)(null),M=async()=>{try{let e=await fetch("/api/members"),s=(await e.json()).find(e=>e.id===t);if(s){let e={...s,memberNumber:parseInt(s.memberNumber?.toString()||"0"),freePTSessions:parseInt(s.freePTSessions?.toString()||"0"),inBodyScans:parseInt(s.inBodyScans?.toString()||"0"),invitations:parseInt(s.invitations?.toString()||"0"),subscriptionPrice:parseInt(s.subscriptionPrice?.toString()||"0"),remainingAmount:parseInt(s.remainingAmount?.toString()||"0")};console.log("Member data:",e),m(e)}else g("❌ لم يتم العثور على العضو")}catch(e){console.error("Error:",e),g("❌ حدث خطأ في تحميل البيانات")}finally{b(!1)}},$=async()=>{if(!x||C.amount<=0){g("⚠️ يرجى إدخال مبلغ صحيح"),setTimeout(()=>g(""),3e3);return}if(C.amount>x.remainingAmount){g("⚠️ المبلغ أكبر من المبلغ المتبقي"),setTimeout(()=>g(""),3e3);return}b(!0),g("");try{let e=parseInt(C.amount.toString()),s=x.remainingAmount-e;if((await fetch("/api/members",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:x.id,remainingAmount:s})})).ok){let s=await fetch("/api/receipts/create-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({memberId:x.id,amount:e,paymentMethod:C.paymentMethod,notes:C.notes})});if(s.ok){let e=await s.json();f({receiptNumber:e.receiptNumber,type:"Payment",amount:e.amount,details:JSON.parse(e.itemDetails),date:new Date(e.createdAt),paymentMethod:C.paymentMethod}),j(!0)}g("✅ تم دفع المبلغ بنجاح!"),setTimeout(()=>g(""),3e3),k({amount:0,paymentMethod:"cash",notes:""}),A(null),M()}else g("❌ فشل تسجيل الدفع")}catch(e){console.error(e),g("❌ حدث خطأ")}finally{b(!1)}},z=async()=>{if(!x||(x.inBodyScans??0)<=0){g("⚠️ لا توجد حصص InBody متبقية"),setTimeout(()=>g(""),3e3);return}D({show:!0,title:"⚖️ استخدام حصة InBody",message:"هل تريد تنقيص حصة InBody؟",onConfirm:async()=>{D(null),b(!0);try{(await fetch("/api/members",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:x.id,inBodyScans:(x.inBodyScans??0)-1})})).ok&&(g("✅ تم تنقيص حصة InBody"),setTimeout(()=>g(""),3e3),M())}catch(e){g("❌ حدث خطأ")}finally{b(!1)}}})},F=async()=>{if(!x||(x.invitations??0)<=0){g("⚠️ لا توجد دعوات متبقية"),setTimeout(()=>g(""),3e3);return}A("invitation")},_=async()=>{if(x){if(!T.guestName.trim()||!T.guestPhone.trim()){g("⚠️ يرجى إدخال اسم ورقم هاتف الضيف"),setTimeout(()=>g(""),3e3);return}b(!0),g("");try{let e=await fetch("/api/invitations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({memberId:x.id,guestName:T.guestName.trim(),guestPhone:T.guestPhone.trim(),notes:T.notes.trim()||void 0})}),s=await e.json();e.ok?(g("✅ تم تسجيل الدعوة بنجاح!"),setTimeout(()=>g(""),3e3),I({guestName:"",guestPhone:"",notes:""}),A(null),M()):(g(`❌ ${s.error||"فشل تسجيل الدعوة"}`),setTimeout(()=>g(""),3e3))}catch(e){console.error(e),g("❌ حدث خطأ في الاتصال"),setTimeout(()=>g(""),3e3)}finally{b(!1)}}},O=async()=>{if(!x||(x.freePTSessions??0)<=0){g("⚠️ لا توجد حصص PT مجانية متبقية"),setTimeout(()=>g(""),3e3);return}D({show:!0,title:"\uD83D\uDCAA استخدام حصة PT مجانية",message:"هل تريد تنقيص حصة PT مجانية؟",onConfirm:async()=>{D(null),b(!0);try{(await fetch("/api/members",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:x.id,freePTSessions:(x.freePTSessions??0)-1})})).ok&&(g("✅ تم تنقيص حصة PT مجانية"),setTimeout(()=>g(""),3e3),M())}catch(e){g("❌ حدث خطأ")}finally{b(!1)}}})},q=async()=>{if(!x||!x.expiryDate||S.days<=0){g("⚠️ يرجى إدخال عدد أيام صحيح"),setTimeout(()=>g(""),3e3);return}b(!0);try{let e=parseInt(S.days.toString()),s=new Date(x.expiryDate),t=new Date(s);t.setDate(t.getDate()+e),(await fetch("/api/members",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:x.id,expiryDate:t.toISOString()})})).ok&&(g(`✅ تم إضافة ${e} يوم للاشتراك`),setTimeout(()=>g(""),3e3),P({days:0,reason:""}),A(null),M())}catch(e){g("❌ حدث خطأ")}finally{b(!1)}},E=async()=>{x&&D({show:!0,title:"⚠️ تأكيد حذف العضو",message:`هل أنت متأكد من حذف العضو "${x.name}" (#${x.memberNumber})؟ لا يمكن التراجع عن هذا الإجراء!`,onConfirm:async()=>{D(null),b(!0);try{(await fetch(`/api/members?id=${x.id}`,{method:"DELETE"})).ok?(g("✅ تم حذف العضو بنجاح"),setTimeout(()=>{s.push("/members")},1500)):g("❌ فشل حذف العضو")}catch(e){console.error(e),g("❌ حدث خطأ في الحذف")}finally{b(!1)}}})};if(u&&!x)return(0,l.jsxs)("div",{className:"container mx-auto p-6 text-center",dir:"rtl",children:[l.jsx("div",{className:"text-6xl mb-4",children:"⏳"}),l.jsx("p",{className:"text-xl",children:"جاري التحميل..."})]});if(!x)return(0,l.jsxs)("div",{className:"container mx-auto p-6 text-center",dir:"rtl",children:[l.jsx("div",{className:"text-6xl mb-4",children:"❌"}),l.jsx("p",{className:"text-xl mb-4",children:"لم يتم العثور على العضو"}),l.jsx("button",{onClick:()=>s.push("/members"),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:"العودة للأعضاء"})]});let J=!!x.expiryDate&&new Date(x.expiryDate)<new Date,U=(0,i.rY)(x.expiryDate);return(0,l.jsxs)("div",{className:"container mx-auto p-6",dir:"rtl",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsxs)("div",{children:[l.jsx("h1",{className:"text-3xl font-bold",children:"\uD83D\uDC64 تفاصيل العضو"}),l.jsx("p",{className:"text-gray-600",children:"إدارة حساب العضو والعمليات المختلفة"})]}),l.jsx("button",{onClick:()=>s.push("/members"),className:"bg-gray-200 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-300",children:"← العودة"})]}),p&&l.jsx("div",{className:`mb-6 p-4 rounded-lg ${p.includes("✅")?"bg-green-100 text-green-800":p.includes("⚠️")?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:p}),(0,l.jsxs)("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-2xl shadow-2xl p-8 mb-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,l.jsxs)("div",{children:[l.jsx("p",{className:"text-sm opacity-90 mb-2",children:"رقم العضوية"}),(0,l.jsxs)("p",{className:"text-5xl font-bold",children:["#",x.memberNumber]})]}),(0,l.jsxs)("div",{children:[l.jsx("p",{className:"text-sm opacity-90 mb-2",children:"الاسم"}),l.jsx("p",{className:"text-3xl font-bold",children:x.name})]}),(0,l.jsxs)("div",{children:[l.jsx("p",{className:"text-sm opacity-90 mb-2",children:"رقم الهاتف"}),l.jsx("p",{className:"text-2xl font-mono",children:x.phone})]})]}),l.jsx("div",{className:"mt-6 pt-6 border-t border-white border-opacity-20",children:(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,l.jsxs)("div",{className:"bg-white bg-opacity-20 rounded-lg p-4",children:[l.jsx("p",{className:"text-sm opacity-90",children:"الحالة"}),l.jsx("p",{className:"text-lg font-bold",children:x.isActive&&!J?"✅ نشط":"❌ منتهي"})]}),(0,l.jsxs)("div",{className:"bg-white bg-opacity-20 rounded-lg p-4",children:[l.jsx("p",{className:"text-sm opacity-90",children:"تاريخ الانتهاء"}),l.jsx("p",{className:"text-lg font-mono",children:(0,i.ze)(x.expiryDate)}),null!==U&&U>0&&(0,l.jsxs)("p",{className:"text-xs opacity-75 mt-1",children:["باقي ",U," يوم"]})]}),(0,l.jsxs)("div",{className:"bg-white bg-opacity-20 rounded-lg p-4",children:[l.jsx("p",{className:"text-sm opacity-90",children:"سعر الاشتراك"}),(0,l.jsxs)("p",{className:"text-2xl font-bold",children:[x.subscriptionPrice," ج.م"]})]}),(0,l.jsxs)("div",{className:"bg-white bg-opacity-20 rounded-lg p-4",children:[l.jsx("p",{className:"text-sm opacity-90",children:"المبلغ المتبقي"}),(0,l.jsxs)("p",{className:"text-2xl font-bold text-yellow-300",children:[x.remainingAmount," ج.م"]})]})]})})]}),l.jsx("div",{className:"mb-6",children:l.jsx(c,{memberNumber:x.memberNumber,memberName:x.name,memberPhone:x.phone})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-r-4 border-green-500",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsxs)("div",{children:[l.jsx("p",{className:"text-gray-600 text-sm",children:"InBody"}),l.jsx("p",{className:"text-4xl font-bold text-green-600",children:x.inBodyScans??0})]}),l.jsx("div",{className:"text-5xl",children:"⚖️"})]}),l.jsx("button",{onClick:z,disabled:(x.inBodyScans??0)<=0||u,className:"w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"استخدام حصة"})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-r-4 border-purple-500",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsxs)("div",{children:[l.jsx("p",{className:"text-gray-600 text-sm",children:"الدعوات"}),l.jsx("p",{className:"text-4xl font-bold text-purple-600",children:x.invitations??0})]}),l.jsx("div",{className:"text-5xl",children:"\uD83C\uDF9F️"})]}),l.jsx("button",{onClick:F,disabled:(x.invitations??0)<=0||u,className:"w-full bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"استخدام دعوة"})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-r-4 border-orange-500",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsxs)("div",{children:[l.jsx("p",{className:"text-gray-600 text-sm",children:"حصص PT مجانية"}),l.jsx("p",{className:"text-4xl font-bold text-orange-600",children:x.freePTSessions??0})]}),l.jsx("div",{className:"text-5xl",children:"\uD83D\uDCAA"})]}),l.jsx("button",{onClick:O,disabled:(x.freePTSessions??0)<=0||u,className:"w-full bg-orange-600 text-white py-2 rounded-lg hover:bg-orange-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"استخدام حصة"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:l.jsx("span",{className:"text-3xl",children:"\uD83D\uDCB0"})}),(0,l.jsxs)("div",{children:[l.jsx("h3",{className:"text-xl font-bold",children:"دفع المبلغ المتبقي"}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["المتبقي: ",x.remainingAmount," ج.م"]})]})]}),l.jsx("button",{onClick:()=>A("payment"),disabled:x.remainingAmount<=0||u,className:"w-full bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed font-bold",children:"دفع مبلغ"})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:l.jsx("span",{className:"text-3xl",children:"❄️"})}),(0,l.jsxs)("div",{children:[l.jsx("h3",{className:"text-xl font-bold",children:"تجميد الاشتراك (Freeze)"}),l.jsx("p",{className:"text-sm text-gray-600",children:"إضافة أيام للاشتراك"})]})]}),l.jsx("button",{onClick:()=>A("freeze"),disabled:!x.expiryDate||u,className:"w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed font-bold",children:"تجميد الاشتراك"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,l.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-300 rounded-xl shadow-lg p-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"bg-green-200 p-3 rounded-full",children:l.jsx("span",{className:"text-3xl",children:"\uD83D\uDD04"})}),(0,l.jsxs)("div",{children:[l.jsx("h3",{className:"text-xl font-bold text-green-800",children:"تجديد الاشتراك"}),l.jsx("p",{className:"text-sm text-green-700",children:"تجديد اشتراك العضو لفترة جديدة"})]})]}),l.jsx("button",{onClick:()=>v(!0),disabled:u,className:"w-full bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed font-bold text-lg shadow-md hover:shadow-lg",children:"\uD83D\uDD04 تجديد الاشتراك"})]}),(0,l.jsxs)("div",{className:"bg-gradient-to-br from-red-50 to-red-100 border-2 border-red-300 rounded-xl shadow-lg p-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"bg-red-200 p-3 rounded-full",children:l.jsx("span",{className:"text-3xl",children:"\uD83D\uDDD1️"})}),(0,l.jsxs)("div",{children:[l.jsx("h3",{className:"text-xl font-bold text-red-800",children:"حذف العضو"}),l.jsx("p",{className:"text-sm text-red-700",children:"حذف العضو نهائياً من النظام"})]})]}),l.jsx("button",{onClick:E,disabled:u,className:"w-full bg-red-600 text-white py-3 rounded-lg hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed font-bold text-lg shadow-md hover:shadow-lg",children:"\uD83D\uDDD1️ حذف العضو"})]})]}),w&&w.show&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:9999},children:(0,l.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[(0,l.jsxs)("div",{className:"text-center mb-6",children:[l.jsx("h3",{className:"text-2xl font-bold mb-3",children:w.title}),l.jsx("p",{className:"text-gray-600 text-lg",children:w.message})]}),(0,l.jsxs)("div",{className:"flex gap-3",children:[l.jsx("button",{type:"button",onClick:()=>{w.onConfirm()},className:"flex-1 bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 font-bold",children:"✅ نعم، تأكيد"}),l.jsx("button",{type:"button",onClick:()=>D(null),className:"flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg hover:bg-gray-300 font-bold",children:"✖️ إلغاء"})]})]})}),"payment"===B&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:9999},onClick:e=>{e.target===e.currentTarget&&A(null)},children:(0,l.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",onClick:e=>e.stopPropagation(),children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[l.jsx("h3",{className:"text-2xl font-bold",children:"\uD83D\uDCB0 دفع المبلغ المتبقي"}),l.jsx("button",{onClick:()=>A(null),className:"text-gray-400 hover:text-gray-600 text-3xl leading-none",type:"button",children:"\xd7"})]}),l.jsx("div",{className:"bg-yellow-50 border-r-4 border-yellow-500 p-4 rounded-lg mb-6",children:(0,l.jsxs)("p",{className:"font-bold text-yellow-800",children:["المبلغ المتبقي: ",x.remainingAmount," ج.م"]})}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["المبلغ المدفوع ",l.jsx("span",{className:"text-red-600",children:"*"})]}),l.jsx("input",{type:"number",value:C.amount||"",onChange:e=>k({...C,amount:parseInt(e.target.value)||0}),max:x.remainingAmount,className:"w-full px-4 py-3 border-2 rounded-lg text-xl focus:outline-none focus:border-blue-500",placeholder:"0",autoFocus:!0})]}),l.jsx("div",{className:"bg-gradient-to-br from-green-50 to-blue-50 border-2 border-green-200 rounded-xl p-5",children:l.jsx(d.ZP,{value:C.paymentMethod,onChange:e=>k({...C,paymentMethod:e}),required:!0})}),(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"ملاحظات"}),l.jsx("textarea",{value:C.notes,onChange:e=>k({...C,notes:e.target.value}),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:border-blue-500",rows:3,placeholder:"ملاحظات إضافية..."})]}),l.jsx("div",{className:"bg-green-50 border-2 border-green-300 rounded-lg p-4",children:(0,l.jsxs)("div",{className:"flex justify-between text-lg",children:[l.jsx("span",{children:"المتبقي بعد الدفع:"}),(0,l.jsxs)("span",{className:"font-bold text-green-600",children:[x.remainingAmount-C.amount," ج.م"]})]})}),(0,l.jsxs)("div",{className:"flex gap-3",children:[l.jsx("button",{type:"button",onClick:$,disabled:u||C.amount<=0,className:"flex-1 bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 disabled:bg-gray-400 font-bold",children:u?"جاري المعالجة...":"✅ تأكيد الدفع"}),l.jsx("button",{type:"button",onClick:()=>A(null),className:"px-6 bg-gray-200 text-gray-700 py-3 rounded-lg hover:bg-gray-300",children:"إلغاء"})]})]})]})}),"freeze"===B&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:9999},onClick:e=>{e.target===e.currentTarget&&A(null)},children:(0,l.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",onClick:e=>e.stopPropagation(),children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[l.jsx("h3",{className:"text-2xl font-bold",children:"❄️ تجميد الاشتراك"}),l.jsx("button",{onClick:()=>A(null),className:"text-gray-400 hover:text-gray-600 text-3xl leading-none",type:"button",children:"\xd7"})]}),(0,l.jsxs)("div",{className:"bg-blue-50 border-r-4 border-blue-500 p-4 rounded-lg mb-6",children:[(0,l.jsxs)("p",{className:"text-sm text-blue-800 mb-2",children:["تاريخ الانتهاء الحالي: ",l.jsx("strong",{children:(0,i.ze)(x.expiryDate)})]}),null!==U&&(0,l.jsxs)("p",{className:"text-sm text-blue-800",children:["الأيام المتبقية: ",(0,l.jsxs)("strong",{children:[U>0?U:0," يوم"]})]})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["عدد الأيام المراد إضافتها ",l.jsx("span",{className:"text-red-600",children:"*"})]}),l.jsx("input",{type:"number",value:S.days||"",onChange:e=>P({...S,days:parseInt(e.target.value)||0}),min:"1",className:"w-full px-4 py-3 border-2 rounded-lg text-xl focus:outline-none focus:border-blue-500",placeholder:"عدد الأيام",autoFocus:!0})]}),(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"السبب"}),l.jsx("textarea",{value:S.reason,onChange:e=>P({...S,reason:e.target.value}),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:border-blue-500",rows:3,placeholder:"سبب التجميد..."})]}),S.days>0&&x.expiryDate&&(0,l.jsxs)("div",{className:"bg-green-50 border-2 border-green-300 rounded-lg p-4",children:[l.jsx("p",{className:"text-sm text-green-800 mb-2",children:"التاريخ الجديد للانتهاء:"}),l.jsx("p",{className:"text-xl font-bold text-green-600",children:(0,i.ze)(new Date(new Date(x.expiryDate).getTime()+864e5*S.days))})]}),(0,l.jsxs)("div",{className:"flex gap-3",children:[l.jsx("button",{type:"button",onClick:q,disabled:u||S.days<=0,className:"flex-1 bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 disabled:bg-gray-400 font-bold",children:u?"جاري المعالجة...":"✅ تأكيد التجميد"}),l.jsx("button",{type:"button",onClick:()=>A(null),className:"px-6 bg-gray-200 text-gray-700 py-3 rounded-lg hover:bg-gray-300",children:"إلغاء"})]})]})]})}),"invitation"===B&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:9999},onClick:e=>{e.target===e.currentTarget&&(A(null),I({guestName:"",guestPhone:"",notes:""}))},children:(0,l.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",onClick:e=>e.stopPropagation(),children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsxs)("h3",{className:"text-2xl font-bold flex items-center gap-2",children:[l.jsx("span",{children:"\uD83C\uDF9F️"}),l.jsx("span",{children:"تسجيل دعوة ضيف"})]}),l.jsx("button",{onClick:()=>{A(null),I({guestName:"",guestPhone:"",notes:""})},className:"text-gray-400 hover:text-gray-600 text-3xl leading-none",type:"button",children:"\xd7"})]}),(0,l.jsxs)("div",{className:"bg-purple-50 border-r-4 border-purple-500 p-4 rounded-lg mb-6",children:[(0,l.jsxs)("p",{className:"font-bold text-purple-800",children:["العضو: ",x.name," (#",x.memberNumber,")"]}),(0,l.jsxs)("p",{className:"text-sm text-purple-700 mt-1",children:["الدعوات المتبقية: ",x.invitations??0]})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["اسم الضيف ",l.jsx("span",{className:"text-red-600",children:"*"})]}),l.jsx("input",{type:"text",value:T.guestName,onChange:e=>I({...T,guestName:e.target.value}),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:border-purple-500",placeholder:"أدخل اسم الضيف",autoFocus:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["رقم هاتف الضيف ",l.jsx("span",{className:"text-red-600",children:"*"})]}),l.jsx("input",{type:"tel",value:T.guestPhone,onChange:e=>I({...T,guestPhone:e.target.value}),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:border-purple-500 font-mono",placeholder:"01xxxxxxxxx",dir:"ltr"})]}),(0,l.jsxs)("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"ملاحظات"}),l.jsx("textarea",{value:T.notes,onChange:e=>I({...T,notes:e.target.value}),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none focus:border-purple-500",rows:3,placeholder:"ملاحظات إضافية عن الضيف..."})]}),l.jsx("div",{className:"bg-green-50 border-2 border-green-300 rounded-lg p-4",children:(0,l.jsxs)("div",{className:"flex items-center gap-2 text-green-800",children:[l.jsx("span",{className:"text-xl",children:"✅"}),(0,l.jsxs)("div",{children:[l.jsx("p",{className:"font-semibold",children:"سيتم:"}),l.jsx("p",{className:"text-sm",children:"• تسجيل دعوة الضيف"}),l.jsx("p",{className:"text-sm",children:"• تنقيص دعوة واحدة من العضو"}),l.jsx("p",{className:"text-sm",children:"• حفظ البيانات في سجل الدعوات"})]})]})}),(0,l.jsxs)("div",{className:"flex gap-3",children:[l.jsx("button",{type:"button",onClick:_,disabled:u||!T.guestName.trim()||!T.guestPhone.trim(),className:"flex-1 bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 disabled:bg-gray-400 font-bold",children:u?"جاري الحفظ...":"✅ تسجيل الدعوة"}),l.jsx("button",{type:"button",onClick:()=>{A(null),I({guestName:"",guestPhone:"",notes:""})},className:"px-6 bg-gray-200 text-gray-700 py-3 rounded-lg hover:bg-gray-300",children:"إلغاء"})]})]})]})}),N&&l.jsx(o,{member:x,onSuccess:e=>{e&&(f({receiptNumber:e.receiptNumber,type:"تجديد عضوية",amount:e.amount,details:e.itemDetails,date:new Date(e.createdAt),paymentMethod:e.paymentMethod||"cash"}),j(!0)),M(),v(!1),g("✅ تم تجديد الاشتراك بنجاح!"),setTimeout(()=>g(""),3e3)},onClose:()=>v(!1)}),h&&y&&l.jsx(r.e,{receiptNumber:y.receiptNumber,type:y.type,amount:y.amount,details:y.details,date:y.date,paymentMethod:y.paymentMethod,onClose:()=>j(!1)})]})}},58864:(e,s,t)=>{"use strict";function l(e){if(!e)return"-";let s="string"==typeof e?new Date(e):e;if(isNaN(s.getTime()))return"-";let t=s.getFullYear(),l=String(s.getMonth()+1).padStart(2,"0"),n=String(s.getDate()).padStart(2,"0");return`${t}-${l}-${n}`}function n(e,s){let t="string"==typeof e?new Date(e):e;return Math.ceil((("string"==typeof s?new Date(s):s).getTime()-t.getTime())/864e5)}function a(e){if(!e)return null;let s="string"==typeof e?new Date(e):e,t=new Date;return t.setHours(0,0,0,0),n(t,s)}function r(e){if(e<30)return`${e} يوم`;let s=Math.round(e/30);return`${e} يوم (≈ ${s} ${1===s?"شهر":"أشهر"})`}t.d(s,{DL:()=>r,pi:()=>n,rY:()=>a,ze:()=>l})},57395:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>l});let l=(0,t(68570).createProxy)(String.raw`C:\Users\amran\Desktop\gym\gym-management\app\members\[id]\page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),l=s.X(0,[8948,9206,6621,9797,2251],()=>t(83606));module.exports=l})();